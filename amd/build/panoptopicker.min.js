/**
 * Functionality for the form element panoptopicker
 *
 * @module     repository_panopto/panoptopicker
 * @copyright  2017 Lancaster University (http://www.lancaster.ac.uk/)
 * @author     Ruslan Kabalin (https://github.com/kabalin)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("repository_panopto/panoptopicker",["jquery","core/ajax","core/templates","core/notification","core/url"],(function($,ajax,templates,notification,url){var contextid=0,onChangeSessionId=function(event){event.target.value&&($("#panoptopicker-area").empty(),addSpinner($("#panoptopicker-area")),ajax.call([{methodname:"repository_panopto_get_session_by_id",args:{sessionid:event.target.value,contextid:contextid}}])[0].done((function(response){renderSessionInfo(response)})).fail((function(ex){ex.backtrace=null,notification.exception(ex)})))},addSpinner=function(element){element.addClass("updating");var spinner=element.find("img.spinner");spinner.length?spinner.show():(spinner=$("<img/>").attr("src",url.imageUrl("i/loading_small")).addClass("spinner").addClass("smallicon"),element.append(spinner))},renderSessionInfo=function(data){var context={};data.session&&$.extend(context,data.session),templates.render("repository_panopto/form_panoptopicker",context).done((function(newHTML){$("#panoptopicker-area").empty().append($(newHTML).html())})).fail(notification.exception)};return{init:function(options){contextid=options.contextid,$("#"+options.elementid).on("change",onChangeSessionId).trigger("change")}}}));

//# sourceMappingURL=panoptopicker.min.js.map